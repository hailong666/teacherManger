import{a as ae,u as oe,c as re,d as ie}from"./article-4bb81948.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";import{r as _,v as T,o as ue,d as u,x as de,e as D,f as F,h as g,g as e,w as l,y as V,i as n,A as se,m as ce,t as c,l as P,E as pe}from"./main-34d96914.js";const fe={class:"article-management"},me={class:"page-header"},ge={class:"pagination-container"},ye={class:"dialog-footer"},_e={key:0},ve={style:{"margin-top":"20px"}},be={class:"article-content"},we={key:0,style:{"margin-top":"20px"}},Ve={__name:"ArticleManagement",setup(he){const U=_(!1),M=_(!1),q=_([]),b=_(!1),z=_(!1),h=_(!1),B=_(null),d=_(null),f=T({search:"",category:"",difficulty:""}),m=T({page:1,limit:10,total:0}),r=T({id:null,title:"",author:"",category:"",difficulty:"",content:"",description:""}),G={title:[{required:!0,message:"请输入课文标题",trigger:"blur"},{min:1,max:100,message:"标题长度在 1 到 100 个字符",trigger:"blur"}],author:[{required:!0,message:"请输入作者",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"change"}],difficulty:[{required:!0,message:"请选择难度",trigger:"change"}],content:[{required:!0,message:"请输入课文内容",trigger:"blur"},{min:10,message:"课文内容至少 10 个字符",trigger:"blur"}]},v=async()=>{var o;try{U.value=!0;const t={page:m.page,limit:m.limit,...f},s=await ae(t);q.value=s.articles||[],m.total=((o=s.pagination)==null?void 0:o.total)||0}catch(t){console.error("获取课文列表失败:",t),V.error("获取课文列表失败")}finally{U.value=!1}},H=()=>{h.value=!1,X(),b.value=!0},J=o=>{h.value=!0,Object.assign(r,{id:o.id,title:o.title,author:o.author,category:o.category,difficulty:o.difficulty,content:o.content,description:o.description||""}),b.value=!0},K=o=>{d.value=o,z.value=!0},Q=async()=>{try{await B.value.validate(),M.value=!0;const o={title:r.title,author:r.author,category:r.category,difficulty:r.difficulty,content:r.content,description:r.description};h.value?(await oe(r.id,o),V.success("课文更新成功")):(await re(o),V.success("课文创建成功")),b.value=!1,await v()}catch(o){console.error("保存课文失败:",o),V.error(h.value?"更新课文失败":"创建课文失败")}finally{M.value=!1}},W=o=>{pe.confirm(`确定要删除课文「${o.title}」吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await ie(o.id),V.success("课文删除成功"),await v()}catch(t){console.error("删除课文失败:",t),V.error("删除课文失败")}}).catch(()=>{})},X=()=>{var o;Object.assign(r,{id:null,title:"",author:"",category:"",difficulty:"",content:"",description:""}),(o=B.value)==null||o.clearValidate()},Y=()=>{Object.assign(f,{search:"",category:"",difficulty:""}),m.page=1,v()},E=o=>({古诗词:"primary",现代诗:"success",散文:"info",文言文:"warning",其他:"default"})[o]||"default",N=o=>({easy:"success",medium:"warning",hard:"danger"})[o]||"default",$=o=>({easy:"简单",medium:"中等",hard:"困难"})[o]||o,j=o=>o?new Date(o).toLocaleString("zh-CN"):"-";return ue(()=>{v()}),(o,t)=>{const s=u("el-button"),x=u("el-input"),p=u("el-form-item"),i=u("el-option"),C=u("el-select"),S=u("el-form"),O=u("el-card"),y=u("el-table-column"),k=u("el-tag"),Z=u("el-table"),ee=u("el-pagination"),A=u("el-col"),R=u("el-row"),I=u("el-dialog"),w=u("el-descriptions-item"),te=u("el-descriptions"),le=de("loading");return D(),F("div",fe,[g("div",me,[t[15]||(t[15]=g("h2",null,"课文管理",-1)),e(s,{type:"primary",onClick:H},{default:l(()=>[...t[14]||(t[14]=[n("新增课文",-1)])]),_:1})]),e(O,{class:"filter-card"},{default:l(()=>[e(S,{model:f,inline:""},{default:l(()=>[e(p,{label:"课文标题"},{default:l(()=>[e(x,{modelValue:f.search,"onUpdate:modelValue":t[0]||(t[0]=a=>f.search=a),placeholder:"请输入课文标题",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(p,{label:"分类"},{default:l(()=>[e(C,{modelValue:f.category,"onUpdate:modelValue":t[1]||(t[1]=a=>f.category=a),placeholder:"选择分类",clearable:"",style:{width:"150px"}},{default:l(()=>[e(i,{label:"全部",value:""}),e(i,{label:"古诗词",value:"古诗词"}),e(i,{label:"现代诗",value:"现代诗"}),e(i,{label:"散文",value:"散文"}),e(i,{label:"文言文",value:"文言文"}),e(i,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"难度"},{default:l(()=>[e(C,{modelValue:f.difficulty,"onUpdate:modelValue":t[2]||(t[2]=a=>f.difficulty=a),placeholder:"选择难度",clearable:"",style:{width:"120px"}},{default:l(()=>[e(i,{label:"全部",value:""}),e(i,{label:"简单",value:"easy"}),e(i,{label:"中等",value:"medium"}),e(i,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:l(()=>[e(s,{type:"primary",onClick:v},{default:l(()=>[...t[16]||(t[16]=[n("搜索",-1)])]),_:1}),e(s,{onClick:Y},{default:l(()=>[...t[17]||(t[17]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(O,{class:"table-card"},{default:l(()=>[se((D(),ce(Z,{data:q.value,stripe:""},{default:l(()=>[e(y,{prop:"id",label:"ID",width:"80"}),e(y,{prop:"title",label:"课文标题","min-width":"200"}),e(y,{prop:"category",label:"分类",width:"120"},{default:l(a=>[e(k,{type:E(a.row.category)},{default:l(()=>[n(c(a.row.category),1)]),_:2},1032,["type"])]),_:1}),e(y,{prop:"difficulty",label:"难度",width:"100"},{default:l(a=>[e(k,{type:N(a.row.difficulty)},{default:l(()=>[n(c($(a.row.difficulty)),1)]),_:2},1032,["type"])]),_:1}),e(y,{prop:"author",label:"作者",width:"120"}),e(y,{prop:"createdBy.name",label:"创建者",width:"120"}),e(y,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(a=>[n(c(j(a.row.createdAt)),1)]),_:1}),e(y,{label:"操作",width:"200",fixed:"right"},{default:l(a=>[e(s,{size:"small",onClick:L=>K(a.row)},{default:l(()=>[...t[18]||(t[18]=[n("查看",-1)])]),_:1},8,["onClick"]),e(s,{size:"small",onClick:L=>J(a.row)},{default:l(()=>[...t[19]||(t[19]=[n("编辑",-1)])]),_:1},8,["onClick"]),e(s,{size:"small",type:"danger",onClick:L=>W(a.row)},{default:l(()=>[...t[20]||(t[20]=[n("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[le,U.value]]),g("div",ge,[e(ee,{"current-page":m.page,"onUpdate:currentPage":t[3]||(t[3]=a=>m.page=a),"page-size":m.limit,"onUpdate:pageSize":t[4]||(t[4]=a=>m.limit=a),"page-sizes":[10,20,50,100],total:m.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:v,onCurrentChange:v},null,8,["current-page","page-size","total"])])]),_:1}),e(I,{modelValue:b.value,"onUpdate:modelValue":t[12]||(t[12]=a=>b.value=a),title:h.value?"编辑课文":"新增课文",width:"800px","close-on-click-modal":!1},{footer:l(()=>[g("div",ye,[e(s,{onClick:t[11]||(t[11]=a=>b.value=!1)},{default:l(()=>[...t[21]||(t[21]=[n("取消",-1)])]),_:1}),e(s,{type:"primary",onClick:Q,loading:M.value},{default:l(()=>[...t[22]||(t[22]=[n("保存",-1)])]),_:1},8,["loading"])])]),default:l(()=>[e(S,{model:r,rules:G,ref_key:"articleFormRef",ref:B,"label-width":"80px"},{default:l(()=>[e(R,{gutter:20},{default:l(()=>[e(A,{span:12},{default:l(()=>[e(p,{label:"课文标题",prop:"title"},{default:l(()=>[e(x,{modelValue:r.title,"onUpdate:modelValue":t[5]||(t[5]=a=>r.title=a),placeholder:"请输入课文标题"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,{span:12},{default:l(()=>[e(p,{label:"作者",prop:"author"},{default:l(()=>[e(x,{modelValue:r.author,"onUpdate:modelValue":t[6]||(t[6]=a=>r.author=a),placeholder:"请输入作者"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(R,{gutter:20},{default:l(()=>[e(A,{span:12},{default:l(()=>[e(p,{label:"分类",prop:"category"},{default:l(()=>[e(C,{modelValue:r.category,"onUpdate:modelValue":t[7]||(t[7]=a=>r.category=a),placeholder:"选择分类",style:{width:"100%"}},{default:l(()=>[e(i,{label:"古诗词",value:"古诗词"}),e(i,{label:"现代诗",value:"现代诗"}),e(i,{label:"散文",value:"散文"}),e(i,{label:"文言文",value:"文言文"}),e(i,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(A,{span:12},{default:l(()=>[e(p,{label:"难度",prop:"difficulty"},{default:l(()=>[e(C,{modelValue:r.difficulty,"onUpdate:modelValue":t[8]||(t[8]=a=>r.difficulty=a),placeholder:"选择难度",style:{width:"100%"}},{default:l(()=>[e(i,{label:"简单",value:"easy"}),e(i,{label:"中等",value:"medium"}),e(i,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{label:"课文内容",prop:"content"},{default:l(()=>[e(x,{modelValue:r.content,"onUpdate:modelValue":t[9]||(t[9]=a=>r.content=a),type:"textarea",rows:10,placeholder:"请输入课文内容",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(p,{label:"描述"},{default:l(()=>[e(x,{modelValue:r.description,"onUpdate:modelValue":t[10]||(t[10]=a=>r.description=a),type:"textarea",rows:3,placeholder:"请输入课文描述（可选）",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(I,{modelValue:z.value,"onUpdate:modelValue":t[13]||(t[13]=a=>z.value=a),title:"查看课文",width:"800px"},{default:l(()=>[d.value?(D(),F("div",_e,[e(te,{column:2,border:""},{default:l(()=>[e(w,{label:"课文标题"},{default:l(()=>[n(c(d.value.title),1)]),_:1}),e(w,{label:"作者"},{default:l(()=>[n(c(d.value.author),1)]),_:1}),e(w,{label:"分类"},{default:l(()=>[e(k,{type:E(d.value.category)},{default:l(()=>[n(c(d.value.category),1)]),_:1},8,["type"])]),_:1}),e(w,{label:"难度"},{default:l(()=>[e(k,{type:N(d.value.difficulty)},{default:l(()=>[n(c($(d.value.difficulty)),1)]),_:1},8,["type"])]),_:1}),e(w,{label:"创建者"},{default:l(()=>{var a;return[n(c((a=d.value.createdBy)==null?void 0:a.name),1)]}),_:1}),e(w,{label:"创建时间"},{default:l(()=>[n(c(j(d.value.createdAt)),1)]),_:1})]),_:1}),g("div",ve,[t[23]||(t[23]=g("h4",null,"课文内容：",-1)),g("div",be,c(d.value.content),1)]),d.value.description?(D(),F("div",we,[t[24]||(t[24]=g("h4",null,"课文描述：",-1)),g("p",null,c(d.value.description),1)])):P("",!0)])):P("",!0)]),_:1},8,["modelValue"])])}}},Ae=ne(Ve,[["__scopeId","data-v-1d7aef6d"]]);export{Ae as default};
